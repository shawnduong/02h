
<!DOCTYPE HTML>
<html lang="" >
    <head>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-532QE72R4N"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-532QE72R4N');
        </script>

        <meta charset="UTF-8">
        <title>Serial Peripheral Interface (SPI) Â· 02h</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="Zero to Hero, a knowledge base for all sorts of computer hacking. This website is maintained as a personal passion project.">
        <meta name="generator" content="HonKit 3.7.1">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

		<link rel="stylesheet" href="/assets/theme.css">
        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../ics/" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../net/">
            
                <a href="../../net/">
            
                    
                    Computer Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../forens/">
            
                <a href="../../forens/">
            
                    
                    Digital Forensics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../">
            
                <a href="../">
            
                    
                    Hardware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../theory/">
            
                <a href="../theory/">
            
                    
                    Circuit Theory
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../theory/basic-concepts.html">
            
                <a href="../theory/basic-concepts.html">
            
                    
                    Basic Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../theory/ohms-law.html">
            
                <a href="../theory/ohms-law.html">
            
                    
                    Ohm's Law
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="./">
            
                <a href="./">
            
                    
                    Communication Protocols
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.4.2.1" data-path="SPI.html">
            
                <a href="SPI.html">
            
                    
                    Serial Peripheral Interface (SPI)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../ics/">
            
                <a href="../ics/">
            
                    
                    Integrated Circuits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../ics/555.html">
            
                <a href="../ics/555.html">
            
                    
                    555
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../ics/74hc595.html">
            
                <a href="../ics/74hc595.html">
            
                    
                    74HC595
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../boards/">
            
                <a href="../boards/">
            
                    
                    Boards
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../GLOSSARY.html">
            
                <a href="../../GLOSSARY.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Serial Peripheral Interface (SPI)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="serial-peripheral-interface-spi">Serial Peripheral Interface (SPI)</h1>
<p>Serial Peripheral Interface (SPI) is a <a href="../../GLOSSARY.html#synchronous-serial-communications-protocol" class="glossary-term" title="A communications protocol in which data is transmitted bit-by-bit over a channel and is synchronized using an external clock signal.">synchronous serial communications protocol</a> commonly found in many hardware systems.</p>
<p>SPI is a de facto standard and has no formal specification; there are many variations of communication protocols all called &quot;SPI.&quot; However, all implementations of SPI follow the same basic idea and are for the most part cross-compatible.</p>
<h2 id="basic-operation">Basic Operation</h2>
<p>SPI follows the <a href="../../GLOSSARY.html#main-sub-model" class="glossary-term" title="A model where a primary &quot;main&quot; device or process controls one or more secondary &quot;sub&quot; devices or processes. This is also known as &quot;primary-secondary,&quot; &quot;leader-worker,&quot; &quot;controller-device,&quot; &quot;master-slave&quot; (deprecated), or any other similar language.">main-sub model</a>.</p>
<p><img src="figures/spi-main-sub.svg" alt></p>
<p>In a <a href="../../GLOSSARY.html#multidrop-configuration" class="glossary-term" title="A configuration in which all components are connected discretely.">multidrop configuration</a> as shown in the figure, the main and all subs share the same SCLK, MOSI, and MISO lines, but there is a different CS line for each sub. This is as opposed to a <a href="../../GLOSSARY.html#daisy-chain-configuration" class="glossary-term" title="A configuration in which the output of one component is the input of another component for all components in the configuration.">daisy chain configuration</a> in which all CS lines would be shared and the main and subs would daisy chain their MISO and MOSI lines together in a ring. However, not all main and sub devices support daisy chaining.</p>
<p>The CS is responsible for enabling a sub to communicate with the main. CS may be seen written as <span style="text-decoration:overline">CS</span>, which denotes that it is <a href="../../GLOSSARY.html#active-low" class="glossary-term" title="When the signal is low, the logic is high. This is commonly represented with an overline.">active low</a> rather than <a href="../../GLOSSARY.html#active-high" class="glossary-term" title="When the signal is high, the logic is high.">active high</a>. When the main wants to communicate with a sub, the main will select the sub using their CS line.</p>
<p>If either the sub or main require a waiting time after CS as per their spec sheet, then the main must wait for that much time. The main will generate a clock signal through SCLK, and then the main and sub will communicate in <a href="../../GLOSSARY.html#full-duplex" class="glossary-term" title="A mode in which communication is allowed in both directions simultaneously.">full duplex</a> mode through MOSI and MISO where one bit is transferred each clock cycle.</p>
<h2 id="sclk">SCLK</h2>
<p>The main is responsible for generating the SCLK signal at a frequency supported by the sub it is trying to communicate with. The SCLK should not exceed the sub&apos;s maximum clock speed, as per the sub&apos;s spec sheet.</p>
<p>The main and sub can use the SCLK to output and sample bits in different ways based on how they&apos;ve defined the clock polarity (CPOL) and clock phase (CPHA) options:</p>
<table>
<thead>
<tr>
<th>CPOL</th>
<th>SCLK Idles At</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Logical low voltage</td>
</tr>
<tr>
<td>1</td>
<td>Logical high voltage</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>CPHA</th>
<th>Bits Outputted When SCLK</th>
<th>Bits Sampled When SCLK</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>transitions TO idle</td>
<td>transitions FROM idle</td>
</tr>
<tr>
<td>1</td>
<td>transitions FROM idle</td>
<td>transitions TO idle</td>
</tr>
</tbody>
</table>
<h2 id="spi-modes">SPI Modes</h2>
<p>In order for the main and sub to communicate, the main must match its CPOL and CPHA with the sub&apos;s, following the sub&apos;s spec sheet. The combination of CPOL and CPHA results in 4 SPI operating modes:</p>
<table>
<thead>
<tr>
<th>SPI Mode</th>
<th>CPOL</th>
<th>CPHA</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="spi-in-development-boards">SPI in Development Boards</h2>
<p>In common development and prototyping boards such as Arduinos and NodeMCUs, there are already pins for SPI communication.</p>
<p>Arduino Uno:</p>
<p><img src="figures/Arduino-Uno-pinout.jpg" alt></p>
<p>NodeMCU:</p>
<p><img src="figures/NodeMCU-pinout.jpg" alt></p>
<p>Note that in the NodeMCU, there are SPI and HSPI pins shown on the left and right of the board pinout figure, respectively. As per the <a href="https://web.archive.org/web/20230324013738/https://nodemcu.readthedocs.io/en/release/modules/spi/" target="_blank">NodeMCU documentation</a>, one should use the HSPI for communication with peripherals; the other SPI pins are used for communicating with the flash chip on development boards with flash functionality.</p>
<p>Although development boards commonly have dedicated CS pins, any digital pin can actually be used as long as it can output a high or low signal. If there aren&apos;t enough pins to spare, other solutions such as multiplexing or using shift registers may be employed to extend the maximum number of subs that can be selected. If the components support it, one can also use a <a href="../../GLOSSARY.html#daisy-chain-configuration" class="glossary-term" title="A configuration in which the output of one component is the input of another component for all components in the configuration.">daisy chain configuration</a> to conserve pins.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Communication Protocols">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../ics/" class="navigation navigation-next " aria-label="Next page: Integrated Circuits">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Serial Peripheral Interface (SPI)","level":"1.4.2.1","depth":3,"next":{"title":"Integrated Circuits","level":"1.4.3","depth":2,"path":"hardware/ics/README.md","ref":"hardware/ics/README.md","articles":[{"title":"555","level":"1.4.3.1","depth":3,"path":"hardware/ics/555.md","ref":"hardware/ics/555.md","articles":[]},{"title":"74HC595","level":"1.4.3.2","depth":3,"path":"hardware/ics/74hc595.md","ref":"hardware/ics/74hc595.md","articles":[]}]},"previous":{"title":"Communication Protocols","level":"1.4.2","depth":2,"path":"hardware/comms/README.md","ref":"hardware/comms/README.md","articles":[{"title":"Serial Peripheral Interface (SPI)","level":"1.4.2.1","depth":3,"path":"hardware/comms/SPI.md","ref":"hardware/comms/SPI.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["toggle-chapters","katex"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"toggle-chapters":{},"katex":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"02h","gitbook":"*","description":"Zero to Hero, a knowledge base for all sorts of computer hacking. This website is maintained as a personal passion project."},"file":{"path":"hardware/comms/SPI.md","mtime":"2023-09-02T16:52:00.900Z","type":"markdown"},"gitbook":{"version":"3.7.1","time":"2023-09-10T00:38:39.007Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

